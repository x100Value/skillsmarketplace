<!doctype html>
<html lang="ru">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>SkillsMarketplace</title>
    <link rel="stylesheet" href="/styles.css" />
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
  </head>
  <body class="app-body">
    <main class="app-shell">
      <header class="topbar">
        <div>
          <h1>SkillsMarketplace</h1>
          <p class="muted">Pro AI Tool in Telegram</p>
        </div>
        <span id="authBadge" class="status-chip chip-muted">Guest</span>
      </header>

      <section class="card auth-card">
        <div class="card-head">
          <h2>Access</h2>
          <button id="meBtn" class="btn-secondary">Refresh</button>
        </div>
        <textarea
          id="initDataInput"
          rows="2"
          placeholder="Telegram initData (fallback for local debug)"
        ></textarea>
        <div class="row-actions">
          <button id="authBtn" class="btn-primary">Continue with Telegram</button>
        </div>
        <p id="authState" class="muted">Not authorized</p>
      </section>

      <section id="tab-home" class="tab-panel active">
        <article class="card hero-card">
          <h2>Dashboard</h2>
          <p class="muted">One tap to start. Credits and usage are always visible.</p>
          <div class="metrics">
            <div class="metric">
              <span class="label">Balance</span>
              <strong id="homeBalance">0</strong>
            </div>
            <div class="metric">
              <span class="label">Available</span>
              <strong id="homeAvailable">0</strong>
            </div>
          </div>
          <div class="row-actions">
            <button id="primaryActionBtn" class="btn-primary">Check Skill</button>
            <button id="tryDemoBtn" class="btn-secondary">Try Demo</button>
          </div>
        </article>

        <article class="card">
          <div class="card-head">
            <h2>Last Activity</h2>
            <button id="homeRefreshBtn" class="btn-secondary">Refresh</button>
          </div>
          <ul id="lastActivityList" class="activity-list"></ul>
        </article>
      </section>

      <section id="tab-tool" class="tab-panel">
        <article class="card">
          <h2>Skill Uniqueness Check</h2>
          <p class="muted">
            Dedicated verifier mode. It does not work as a chatbot and only returns
            uniqueness analysis.
          </p>
          <div class="row">
            <label for="skillTitleInput">Skill title</label>
            <input
              id="skillTitleInput"
              type="text"
              maxlength="160"
              placeholder="Example: Telegram Lead Qualification Agent"
            />
          </div>
          <div class="row">
            <label for="skillModeInput">Provider mode</label>
            <select id="skillModeInput">
              <option value="hybrid">Hybrid (paid fallback to free)</option>
              <option value="paid">Paid only</option>
              <option value="free">Free only</option>
            </select>
          </div>
          <textarea
            id="skillTextInput"
            rows="8"
            placeholder="Paste your full skill/prompt text (min 80 chars)"
          ></textarea>
          <div class="inline-status">
            <span class="label">Estimated price</span>
            <span id="toolPrice" class="status-chip chip-muted">not calculated</span>
          </div>
          <div class="row-actions">
            <button id="quoteBtn" class="btn-secondary">Get Quote</button>
            <button id="runBtn" class="btn-primary">Run Check</button>
          </div>
          <div class="inline-status">
            <span class="label">Status</span>
            <span id="toolStatus" class="status-chip chip-muted">idle</span>
          </div>
          <pre id="toolQuote"></pre>
          <pre id="skillReport"></pre>
          <pre id="taskResult"></pre>
        </article>
      </section>

      <section id="tab-history" class="tab-panel">
        <article class="card">
          <div class="card-head">
            <h2>History</h2>
            <button id="historyRefreshBtn" class="btn-secondary">Refresh</button>
          </div>
          <ul id="historyList" class="activity-list"></ul>
        </article>
      </section>

      <section id="tab-wallet" class="tab-panel">
        <article class="card">
          <h2>Wallet / Billing</h2>
          <div class="metrics">
            <div class="metric">
              <span class="label">Total</span>
              <strong id="walletTotal">0</strong>
            </div>
            <div class="metric">
              <span class="label">Held</span>
              <strong id="walletHeld">0</strong>
            </div>
            <div class="metric">
              <span class="label">Available</span>
              <strong id="walletAvailable">0</strong>
            </div>
          </div>
        </article>

        <article class="card">
          <h2>Top Up (Telegram Stars)</h2>
          <p class="muted">Instant access via Telegram Stars.</p>
          <div class="row-actions">
            <button class="btn-secondary topup-btn" data-package="100">100 credits</button>
            <button class="btn-secondary topup-btn" data-package="500">500 credits</button>
            <button class="btn-secondary topup-btn" data-package="1000">1000 credits</button>
          </div>
        </article>

        <article class="card">
          <h2>Advanced Payments (Crypto)</h2>
          <p class="muted">For power users and large deposits.</p>
          <a class="text-link" href="/pro" target="_blank" rel="noreferrer"
            >Open Pro Dashboard</a
          >
        </article>

        <article class="card">
          <h2>Withdrawal</h2>
          <div class="row">
            <label for="withdrawInput">Request amount (stars)</label>
            <input id="withdrawInput" type="number" min="1" value="50" />
          </div>
          <button id="withdrawBtn" class="btn-primary">Create Request</button>
        </article>
      </section>

      <section id="tab-settings" class="tab-panel">
        <article class="card">
          <h2>Settings</h2>
          <button id="logoutBtn" class="btn-secondary">Log out</button>
        </article>
        <article class="card">
          <h2>Legal</h2>
          <p class="muted">Актуальные документы сервиса и правила обработки данных.</p>
          <a class="text-link legal-link" href="/legal" target="_blank" rel="noreferrer"
            >Open Legal Center</a
          >
          <a class="text-link legal-link" href="/docs/LEGAL_OFFER_RU.md" target="_blank" rel="noreferrer"
            >Public Offer</a
          >
          <a class="text-link legal-link" href="/docs/PRIVACY_POLICY_RU.md" target="_blank" rel="noreferrer"
            >Privacy Policy</a
          >
          <a class="text-link legal-link" href="/docs/REFUND_POLICY_RU.md" target="_blank" rel="noreferrer"
            >Refund Rules</a
          >
        </article>
        <article class="card">
          <h2>Debug Log</h2>
          <pre id="log"></pre>
        </article>
      </section>
    </main>

    <nav class="bottom-nav">
      <button class="tab-btn active" data-tab="home">Home</button>
      <button class="tab-btn" data-tab="tool">Tool</button>
      <button class="tab-btn" data-tab="history">History</button>
      <button class="tab-btn" data-tab="wallet">Wallet</button>
      <button class="tab-btn" data-tab="settings">Settings</button>
    </nav>

    <script type="module" src="/app.js"></script>
  </body>
</html>
